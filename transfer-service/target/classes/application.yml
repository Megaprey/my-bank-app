server:
  port: 8083

resilience4j:
  circuitbreaker:
    instances:
      accountClient:
        failure-rate-threshold: 50
        wait-duration-in-open-state: 10s
        sliding-window-size: 10
      notificationClient:
        failure-rate-threshold: 50
        wait-duration-in-open-state: 10s
        sliding-window-size: 10
  retry:
    instances:
      accountClient:
        max-attempts: 3
        wait-duration: 500ms
        retry-exceptions:
          - org.springframework.web.reactive.function.client.WebClientResponseException
          - java.io.IOException
      notificationClient:
        max-attempts: 3
        wait-duration: 500ms
        retry-exceptions:
          - org.springframework.web.reactive.function.client.WebClientResponseException
          - java.io.IOException

spring:
  application:
    name: transfer-service
  security:
    oauth2:
      resourceserver:
        jwt:
          jwk-set-uri: ${SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_JWKSETURI:http://localhost:9000/oauth2/jwks}
      client:
        registration:
          transfer-client:
            provider: auth-server
            client-id: ${OAUTH2_CLIENT_ID:transfer-client}
            client-secret: ${OAUTH2_CLIENT_SECRET:transfer-secret}
            authorization-grant-type: client_credentials
            scope: accounts,notifications
        provider:
          auth-server:
            token-uri: ${SPRING_SECURITY_OAUTH2_CLIENT_PROVIDER_AUTHSERVER_TOKENURI:http://localhost:9000/oauth2/token}

services:
  accounts:
    url: ${ACCOUNTS_SERVICE_URL:http://localhost:8081}
  notifications:
    url: ${NOTIFICATIONS_SERVICE_URL:http://localhost:8084}

logging:
  level:
    root: ${LOG_LEVEL:WARN}
    com.bank: ${LOG_LEVEL:INFO}
    io.github.resilience4j: ${LOG_LEVEL_RESILIENCE4J:DEBUG}
